<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <title>System V Calling Conversions | 項 思 偉 ~ Aal Izz Well!</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/xin">Home</a></li>
      
      <li><a href="/">Articles</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">System V Calling Conversions</span></h1>
</div>

<main>


<h1 id="system-v-i386">System V i386</h1>

<ul>
<li>Parameters</li>
</ul>

<p>Parameters are passed on the stack, with the first argument at the
lowest address on the stack at the time of the call (pushed last, so
it&rsquo;s just above the return address on entry to the function). The
caller is responsible for popping parameters back off the stack after
the call.</p>

<ul>
<li>Return Value</li>
</ul>

<p>For scalar return types, the return value is placed in EAX, or EDX:EAX
for 64bit integers. Floating-point types are returned in st0
(x87). Returning larger types like structures is done by reference,
with a pointer passed as an implicit first parameter. (This pointer is
returned in EAX, so the caller doesn&rsquo;t have to remember what it
passed).</p>

<ul>
<li>Saved and Clobbered Registers</li>
</ul>

<p>EBX, EDI, ESI, EBP, and ESP (and FP / SSE rounding mode settings) must
be preserved by the callee, such that the caller can rely on those
registers not having been changed by a call.</p>

<p>All other registers (EAX, ECX, EDX, FLAGS (other than DF), x87 and
vector registers) may be freely modified by the callee; if a caller
wishes to preserve a value before and after the function call, it must
save the value elsewhere (such as in one of the saved registers or on
the stack).</p>

<h1 id="system-v-x86-64">System V x86-64</h1>

<ul>
<li>Parameters</li>
</ul>

<p>The first eight scalar parameters are passed in (in order) RDI, RSI,
RDX, RCX, R8, R9, R10, R11. Parameters past the first eight are placed
on the stack, with earlier parameters closer to the top of the
stack. The caller is responsible for popping these values off the
stack after the call if no longer needed.</p>

<ul>
<li>Return Value</li>
</ul>

<p>For scalar return types, the return value is placed in RAX. Returning
larger types like structures is done by conceptually changing the
signature of the function to add a parameter at the beginning of the
parameter list that is a pointer to a location in which to place the
return value.</p>

<ul>
<li>Saved and Clobbered Registers</li>
</ul>

<p>RBP, RBX, and R12–R15 are preserved by the callee. All other registers
may be modified by the callee, and the caller must preserve a
register’s value itself (e.g. on the stack) if it wishes to use that
value later.</p>

</main>

  <footer>
  
  
  <hr/>
  &copy; [項思偉] 2017 | <a href="https://github.com/daveixiang">Github</a>
  
  </footer>
  </body>
</html>

