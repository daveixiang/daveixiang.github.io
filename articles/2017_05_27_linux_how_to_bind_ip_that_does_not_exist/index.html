<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Linux: How to bind IP that doesn&#39;t exist // 項 思 偉 ~ Aal Izz Well!</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:title" content="Linux: How to bind IP that doesn&#39;t exist" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://daveixiang.github.io/articles/2017_05_27_linux_how_to_bind_ip_that_does_not_exist/" />


    <link href="" rel="alternate" type="application/rss+xml" title="項 思 偉 ~ Aal Izz Well!" />
    <link rel="shortcut icon" href="https://daveixiang.github.io/favicon.png">

    <link href="https://daveixiang.github.io/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://daveixiang.github.io/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://daveixiang.github.io/css/style.css">

    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="">

    <meta name="generator" content="Hugo 0.22-DEV" />
</head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://daveixiang.github.io/">項 思 偉 ~ Aal Izz Well!</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="https://daveixiang.github.io/xin">0x00 xin</a>
                
                <a class="main-nav-link" href="https://daveixiang.github.io/tags/">0x01 Tags</a>
                
                <a class="main-nav-link" href="https://daveixiang.github.io/categories/">0x02 Categories</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">Linux: How to bind IP that doesn&#39;t exist</h1>
        </header>
        
        <div class="article-meta">
            <a href="https://daveixiang.github.io/articles/2017_05_27_linux_how_to_bind_ip_that_does_not_exist/" class="article-date">
                <time datetime='2017-05-27T00:00:00.000&#43;00:00' itemprop="datePublished">2017-05-27</time>
            </a>
            
            
            <div class="post-categories">
                <div class="article-category">
                    
                    
                    <a class="article-category-link" href="https://daveixiang.github.io//categories/tips">tips</a>
                    
                </div>
            </div>
            
            
        </div>
        <div class="article-entry" itemprop="articleBody">
            <p>This tip is really usefull if you use virtual ips.</p>

<p>Imagine you are using keepalived + haproxy on your loadbalancers in
active/active mode.</p>

<p>You have 2 virtual IPs one is on the first load balancer and the other
is on the second.</p>

<p>Now in your haproxy.cfg you have to bind these IPs, the probem is that
one of the virtual IPs is not on the current loadbalancer, so haproxy
will refuse to start with the following error: cannot bind socket.</p>

<p>The common solution is to listen on 0.0.0.0, but it not always
practical on wanted, especially if you want to have another server
using the same port but on another ip, or if you only want to listen
on internal interfaces.</p>

<p>The solution is a sysctl that will allow any software to bind an IP
even if it’s not up yet:</p>

<pre><code class="language-bash">sysctl -w net.ipv4.ip_nonlocal_bind=1
</code></pre>

<p>You should put this in <em>/etc/sysctl.conf</em> to make this change permanent.</p>

        </div>

        
        <footer class="article-footer">
            <ul class="article-tag-list">
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://daveixiang.github.io//tags/linux">linux
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://daveixiang.github.io//tags/haproxy">haproxy
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://daveixiang.github.io//tags/keepalived">keepalived
                    </a>
                </li>
                
            </ul>
        </footer>
        
    </div>
    <nav id="article-nav">
    
    <a href="https://daveixiang.github.io/articles/2017_05_30_openstack_restful_api_example_mitaka/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            OpenStack RESTful API example(Mitaka)
        </div>
    </a>
    
    
    <a href="https://daveixiang.github.io/articles/2017_05_10_sheepdog_add_pthread_name/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">sheepdog add pthread name&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>
</article>

        
    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2017 項 思 偉 ~ Aal Izz Well!&nbsp;
            Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos">Minos</a>
        </div>
    </div>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>

</div>
</body>
</html>
