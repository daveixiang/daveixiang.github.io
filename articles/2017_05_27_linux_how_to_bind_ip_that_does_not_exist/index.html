<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <title>Linux: How to bind IP that doesn&#39;t exist | 項 思 偉 ~ Aal Izz Well!</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/xin">Home</a></li>
      
      <li><a href="/">Articles</a></li>
      
      <li><a href="/categories/">Categories</a></li>
      
      <li><a href="/tags/">Tags</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Linux: How to bind IP that doesn&#39;t exist</span></h1>
</div>

<main>
<p>This tip is really usefull if you use virtual ips.</p>

<p>Imagine you are using keepalived + haproxy on your loadbalancers in
active/active mode.</p>

<p>You have 2 virtual IPs one is on the first load balancer and the other
is on the second.</p>

<p>Now in your haproxy.cfg you have to bind these IPs, the probem is that
one of the virtual IPs is not on the current loadbalancer, so haproxy
will refuse to start with the following error: cannot bind socket.</p>

<p>The common solution is to listen on 0.0.0.0, but it not always
practical on wanted, especially if you want to have another server
using the same port but on another ip, or if you only want to listen
on internal interfaces.</p>

<p>The solution is a sysctl that will allow any software to bind an IP
even if it’s not up yet:</p>

<pre><code class="language-bash">sysctl -w net.ipv4.ip_nonlocal_bind=1
</code></pre>

<p>You should put this in <em>/etc/sysctl.conf</em> to make this change permanent.</p>

</main>

  <footer>
  
  
  <hr/>
  &copy; [項思偉] 2017 | <a href="https://github.com/daveixiang">Github</a>
  
  </footer>
  </body>
</html>

