<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sheepdog on 項 思 偉 ~ Aal Izz Well!</title>
    <link>https://daveixiang.github.io/tags/sheepdog/</link>
    <description>Recent content in Sheepdog on 項 思 偉 ~ Aal Izz Well!</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Wed, 10 May 2017 00:00:00 +0000</lastBuildDate>
    
	<atom:link href="https://daveixiang.github.io/tags/sheepdog/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>sheepdog add pthread name</title>
      <link>https://daveixiang.github.io/articles/2017_05_10_sheepdog_add_pthread_name/</link>
      <pubDate>Wed, 10 May 2017 00:00:00 +0000</pubDate>
      
      <guid>https://daveixiang.github.io/articles/2017_05_10_sheepdog_add_pthread_name/</guid>
      <description>Because sheepdog is multi-thread program. So I think it&amp;rsquo;s better to add pthread name for convenient.
diff --git a/lib/work.c b/lib/work.c index 75b0807..3b40bf8 100644 --- a/lib/work.c +++ b/lib/work.c @@ -260,11 +260,21 @@ static int create_worker_threads(struct wq_info *wi, size_t nr_threads) int ret; while (wi-&amp;gt;nr_threads &amp;lt; nr_threads) { + char thdname[16]; ret = pthread_create(&amp;amp;thread, NULL, worker_routine, wi); if (ret != 0) { sd_err(&amp;quot;failed to create worker thread: %m&amp;quot;); return -1; } + + + snprintf(thdname, 16, &amp;quot;%s:%zu&amp;quot;, wi-&amp;gt;name, wi-&amp;gt;nr_threads); + + ret = pthread_setname_np(thread, thdname); + if (ret !</description>
    </item>
    
  </channel>
</rss>